ANTEHM


STEP 1 : 
ENUMERATION


"""
                                                                                                                                                                        
┌──(kali㉿kali)-[~/Desktop/THM/OFFENSIVE_PENTESTING/Anthem]
└─$ sudo nmap -sS -sV -Pn  -p 0-2000 10.10.66.135 -oN nmap.txt                                                                                                      1 ⨯
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-20 22:53 EST
Stats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 8.62% done; ETC: 22:54 (0:01:14 remaining)
Nmap scan report for 10.10.66.135
Host is up (0.19s latency).
Not shown: 2000 filtered tcp ports (no-response)
PORT   STATE SERVICE VERSION
80/tcp open  http    Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 74.84 seconds


"""

SCAN 2

"""
└─$ sudo nmap -sS -sV -sC -Pn  10.10.66.135  -oN nmap2.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-20 23:09 EST
Nmap scan report for 10.10.66.135
Host is up (0.19s latency).
Not shown: 998 filtered tcp ports (no-response)
PORT     STATE SERVICE       VERSION
80/tcp   open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
| http-robots.txt: 4 disallowed entries 
|_/bin/ /config/ /umbraco/ /umbraco_client/
|_http-title: Anthem.com - Welcome to our blog
3389/tcp open  ms-wbt-server Microsoft Terminal Services
| rdp-ntlm-info: 
|   Target_Name: WIN-LU09299160F
|   NetBIOS_Domain_Name: WIN-LU09299160F
|   NetBIOS_Computer_Name: WIN-LU09299160F
|   DNS_Domain_Name: WIN-LU09299160F
|   DNS_Computer_Name: WIN-LU09299160F
|   Product_Version: 10.0.17763
|_  System_Time: 2022-02-21T04:09:43+00:00
| ssl-cert: Subject: commonName=WIN-LU09299160F
| Not valid before: 2022-02-20T03:50:04
|_Not valid after:  2022-08-22T03:50:04
|_ssl-date: 2022-02-21T04:10:10+00:00; +2s from scanner time.
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Host script results:
|_clock-skew: mean: 1s, deviation: 0s, median: 0s

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 59.83 seconds

"""

RESULTS 
WEBSITE 



VIEW SOURCE CODE 


"""
        <h2 class="blog-description">
    Welcome to our blog
</h2>
        <nav class="menu" role="nav">
    <ul>
        <li><a href="/categories">Categories</a></li>
        <li><a href="/tags">Tags</a></li>
        <li>
            <div class="articulate-search">
    <form method="get" action="/search">
        <input type="text" name="term" placeholder="Search... 		THM{G!T_G00D}" />
        <button type="submit" class="fa fa-search fa"></button>
    </form>
</div>
        </li>
    </ul>
</nav>

    </header>

"""

FLAG 2 FOUND THM{G!T_G00D}:


DIRECTORY SCAN:

GOBUSTER

"""

┌──(kali㉿kali)-[~/Desktop/THM/OFFENSIVE_PENTESTING/Anthem]
└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.66.135/ 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.66.135/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/20 22:59:41 Starting gobuster in directory enumeration mode
===============================================================
/archive              (Status: 301) [Size: 118] [--> /]
/Archive              (Status: 301) [Size: 118] [--> /]
/authors              (Status: 200) [Size: 4070]       
/blog                 (Status: 200) [Size: 5394]       
/Blog                 (Status: 200) [Size: 5394]       
/categories           (Status: 200) [Size: 3541]       
Progress: 1741 / 4615 (37.72%)                        [ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/fx": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/g": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/G": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 1744 / 4615 (37.79%)                        [ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/ga": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/gadget": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/gadgets": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/gaestebuch": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/galeria": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/galerie": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:01:44 [!] Get "http://10.10.66.135/galleries": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/install              (Status: 302) [Size: 126] [--> /umbraco/]
Progress: 2409 / 4615 (52.20%)                                [ERROR] 2022/02/20 23:03:27 [!] Get "http://10.10.66.135/lpt2": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
[ERROR] 2022/02/20 23:03:27 [!] Get "http://10.10.66.135/lpt1": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 2751 / 4615 (59.61%)                                [ERROR] 2022/02/20 23:04:54 [!] Get "http://10.10.66.135/nul": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/robots.txt           (Status: 200) [Size: 192]                
/rss                  (Status: 200) [Size: 1873]               
/RSS                  (Status: 200) [Size: 1873]               
/search               (Status: 200) [Size: 3468]               
/Search               (Status: 200) [Size: 3468]               
/sitemap              (Status: 200) [Size: 1041]               
/SiteMap              (Status: 200) [Size: 1041]               
/tags                 (Status: 200) [Size: 3594]               
/umbraco              (Status: 200) [Size: 4078]     


"""




ROBOTS.TXT CONTENTS 

"""
UmbracoIsTheBest!

# Use for all search robots
User-agent: *

# Define the directories not to crawl
Disallow: /bin/
Disallow: /config/
Disallow: /umbraco/
Disallow: /umbraco_client/


"""

 
Found FLAG 3  at http://10.10.66.135/authors/jane-doe/  THM{L0L_WH0_D15} with embeded link 



TASK 1 ANSWERS 
""""

 Task 1 Website Analysis

This task involves you, paying attention to details and finding the 'keys to the castle'.

This room is designed for beginners, however, everyone is welcomed to try it out!

Enjoy the Anthem.

In this room, you don't need to brute force any login page. Just your preferred browser and Remote Desktop.

Please give the box up to 5 minutes to boot and configure.
Answer the questions below

Let's run nmap and check what ports are open.
no answer

What port is for the web server?
80

What port is for remote desktop service?
3389

What is a possible password in one of the pages web crawlers check for?
UmbracoIsTheBest!

What CMS is the website using?
umbraco
What is the domain of the website?
Anthem.com

What's the name of the Administrator
Solomon Grundy

Can we find find the email address of the administrator?
SG@anthem.com



""""

Flag 1 found at source code of  view-source:http://10.10.66.135/archive/we-are-hiring/   > THM{L0L_WH0_US3S_M3T4}



Flag 4 found view-source:http://10.10.66.135/archive/a-cheers-to-our-it-department/ >   THM{AN0TH3R_M3TA}



Log in using rdesktop 

username = SG
Password = UmbracoIsTheBest!

user flag 

THM{N00T_NO0T}


Admin Password
ChangeMeBaby1MoreTime

root
THM{Y0U_4R3_1337}





